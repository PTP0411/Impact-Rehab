<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visit Details - Impact Rehab</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <h1>Visit Details</h1>
    <button id="back-btn">‚Üê Back to Patient</button>
  </header>

  <main class="visit-container">
    <section class="visit-info">
      <h2 id="visit-date">Visit Date: </h2>
      <p><strong>Patient:</strong> John Doe</p>
    </section>

    <section class="visit-scores">
      <h3>Test Scores</h3>

      <!-- Overall Score Pie Chart -->
      <div class="overall-score-chart">
        <canvas id="overallChart"></canvas>
      </div>

      <table>
        <thead>
          <tr>
            <th>Test</th>
            <th>Score</th>
          </tr>
        </thead>
        <tbody>
          <!-- HumanTrak -->
          <tr><td>Standing posture</td><td>8/10</td></tr>
          <tr><td>Neck flexion</td><td>7/10</td></tr>
          <tr><td>Neck lateral flexion</td><td>7/10</td></tr>
          <tr><td>Neck rotation</td><td>8/10</td></tr>
          <tr><td>Shoulder flexion</td><td>9/10</td></tr>
          <tr><td>Shoulder external rotation 90 abduction</td><td>8/10</td></tr>
          <tr><td>Shoulder internal rotation 90 abduction</td><td>7/10</td></tr>
          <tr><td>Trunk flexion</td><td>8/10</td></tr>
          <tr><td>Trunk lateral flexion</td><td>7/10</td></tr>
          <tr><td>Trunk rotation</td><td>8/10</td></tr>
          <tr><td>Trunk extension</td><td>7/10</td></tr>
          <tr><td>Overhead squat</td><td>9/10</td></tr>
          <tr><td>Lunge</td><td>8/10</td></tr>
          <tr><td>Squat</td><td>8/10</td></tr>
          <tr><td>Seated hip ER</td><td>7/10</td></tr>
          <tr><td>Seated hip IR</td><td>7/10</td></tr>

          <!-- Dynamo -->
          <tr><td>Grip strength</td><td>35kg</td></tr>

          <!-- ForceDecks -->
          <tr><td>Quiet stand EO</td><td>9/10</td></tr>
          <tr><td>Quiet stand EC</td><td>8/10</td></tr>
          <tr><td>SLS EO</td><td>7/10</td></tr>
          <tr><td>SLS EC</td><td>7/10</td></tr>
          <tr><td>CMJ</td><td>50cm</td></tr>
          <tr><td>SQJ</td><td>45cm</td></tr>
          <tr><td>SL Jump</td><td>48cm</td></tr>
          <tr><td>IMTP</td><td>500N</td></tr>
        </tbody>
      </table>
    </section>
  </main>

  <script>
    // Back to patient page
    document.getElementById("back-btn").addEventListener("click", () => {
      window.history.back();
    });

    // Get visit date from query string
    const params = new URLSearchParams(window.location.search);
    const visitDate = params.get('date');
    document.getElementById('visit-date').textContent = `Visit Date: ${visitDate}`;

    // Pie chart for Overall Score
    const overallCtx = document.getElementById('overallChart').getContext('2d');
    const overallChart = new Chart(overallCtx, {
      type: 'doughnut',
      data: {
        labels: ['Score Achieved', 'Remaining'],
        datasets: [{
          data: [78, 22], // Example overall score
          backgroundColor: ['#7ab92f', '#ddd'],
          borderWidth: 0
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' },
          tooltip: { callbacks: {
            label: function(context) {
              return `${context.label}: ${context.raw}`;
            }
          }}
        }
      }
    });
  </script>
</body>
</html>
